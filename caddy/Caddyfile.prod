{$DOMAIN_NAME:localhost} {
	encode zstd gzip
	tls internal

	# API reverse proxy
	handle_path /api/* {
		reverse_proxy server:3000
	}

	# Serve built SPA from the shared volume
	handle_path /* {
		root * /app/dist
		@static {
			path *.js *.css *.png *.jpg *.jpeg *.gif *.svg *.ico *.woff *.woff2 *.ttf *.eot
		}
		header @static Cache-Control "public, max-age=31536000, immutable"
		try_files {path} /index.html
		file_server
	}

	log {
		output file /var/log/caddy/access.log
		format json
	}
}
